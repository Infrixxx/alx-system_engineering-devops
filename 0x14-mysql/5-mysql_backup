#!/usr/bin/env bash
# MySQL backup script

# Directory to store backups (replace /path/to/backup/directory with the actual path)
BACKUP_DIR="/path/to/backup/directory"

# Ensure the backup directory exists
mkdir -p "$BACKUP_DIR"

# Create a timestamp for the backup file
TIMESTAMP=$(date +'%d-%m-%Y')

# MySQL dump command (no password)
mysqldump --all-databases > "$BACKUP_DIR/backup.sql"

# Check if mysqldump was successful
if [ $? -ne 0 ]; then
    echo "MySQL dump failed. Exiting."
    exit 1
fi

# Create a tar-gzipped archive
tar -czvf "$BACKUP_DIR/$TIMESTAMP.tar.gz" -C "$BACKUP_DIR" backup.sql

# Check if tar was successful
if [ $? -ne 0 ]; then
    echo "Creating archive failed. Exiting."
    exit 1
fi

# Cleanup: remove the temporary MySQL dump
rm "$BACKUP_DIR/backup.sql"

echo "Backup completed successfully."
